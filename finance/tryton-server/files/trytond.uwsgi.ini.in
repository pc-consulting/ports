[uwsgi]
#uWSGI settings, cf. https://www.bloomberg.com/company/stories/configuring-uwsgi-production-deployment
strict = true
master = true
enable-threads = true
vacuum = true
single-interpreter = true
die-on-term = true
need-app = true

disable-logging = false
log-4xx = true
log-5xx = true

harakiri = 60
#py-callos-afterfork = true

max-requests = 1000
max-worker-lifetime = 3600
reload-on-rss = 2048
worker-reload-mercy = 60

cheaper-algo = busyness
processes = 32
#cheaper = 4
cheaper-initial = 4
cheaper-overload = 1
cheaper-step = 4

cheaper-busyness-multiplier = 30
cheaper-busyness-min = 20
cheaper-busyness-max = 70
#cheaper-busyness-backlog-alert = 16
#cheaper-busyness-backlog-step = 2

# Actual trytond items.
# procname-prefix is not helpful _stopping_ via service/rc.d ...
#procname-prefix = "trytond "
#http-socket = localhost:8421
uwsgi-socket = localhost:8421
master = true
wsgi = trytond.application:app
cheaper = 4
processes = 16
threads= 16
# Environment variables, see https://docs.tryton.org/projects/server/en/latest/topics/start_server.html#wsgi-server
env = TRYTON_CONFIG=%%PREFIX%%/etc/trytond.conf
env = TRYTON_LOGGING_CONFIG=%%PREFIX%%/etc/tryton.logconf
# Can be controlled form tryton.logconf
# env = TRYTOND_LOGGING_LEVEL=INFO
env = TRYTON_COROUTINE=YES
# Let's also just set the database in one single place, please, i. e. trtond.conf
# env = TRYTON_DATABASE_NAMES=db
